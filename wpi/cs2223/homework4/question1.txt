The algorithm fails because it is incapable of doing row swaps.